<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>物流狀態查詢</title>
    <!-- 引入 Bootstrap CSS -->
    <link rel="stylesheet" href="./assets/style/bootstrap.min.css">
    <!-- 引入 Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <!-- 引入 Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- 引入 Axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        .hidden { display: none; }
    </style>
</head>
<body>
    <div id="app">
        <!-- UI 1-1 -->
        <div v-if="!showResults" class="container">
            <div class="d-flex justify-content-between align-items-center mt-3">
                <img src="./assets/images/logo_1.png" alt="Logo">
                <button class="btn btn-transparent btn-primary">
                    Language <i class="bi bi-globe"></i>
                </button>
            </div>
            <div class="d-flex justify-content-center mb-3">
                <button class="btn btn-outline-transparent me-2" @click="view = 'standard'">查詢包裹</button>
                <button class="btn btn-transparent" @click="view = 'unknown'">查詢不明包裹</button>
            </div>
            <h1 class="mt-5 text-center">您的包裹在哪？</h1>
            <p class="text-center">請輸入包裹代碼</p>
            <div class="d-flex justify-content-center">
                <input type="text" v-model="trackingNumber" class="form-control w-50" placeholder="輸入物流單號">
                <button class="btn btn-outline-transparent ms-2">
                    <i class="bi bi-upc-scan"></i>
                </button>
            </div>
            <div class="d-flex justify-content-center mt-3">
                <button class="btn btn-secondary me-2" @click="clearInput">清除重填</button>
                <button class="btn btn-primary" @click="fetchData">查詢</button>
            </div>
            <p class="text-center mt-3">輸入包裹查詢的啟用條款符合「*」或電子或是字母等符號。資料保留時間僅備三個月，您的系統無法查詢三個月之前的資料。</p>
        </div>
        <!-- UI 1-2 -->
        <div v-if="showResults" class="container mt-5">
            <div class="d-flex justify-content-between">
                <div>
                    <h1>物流狀態查詢結果</h1>
                    <h2>物流單號: {{ data.shipmentNo }}</h2>
                </div>
                <button class="btn btn-outline-secondary" @click="showResults = false">返回</button>
            </div>
            <ul class="list-group mt-4">
                <li class="list-group-item" v-for="status in data.statuses" :key="status.id">
                    <i class="bi bi-box-seam"></i> {{ status.status }} - {{ status.timestamp }}
                </li>
            </ul>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    trackingNumber: '',
                    data: null,
                    loading: false,
                    error: false,
                    showResults: false,
                    view: 'standard',
                };
            },
            methods: {
                fetchData() {
                    if (this.trackingNumber) {
                        this.loading = true;
                        axios.get(`https://wms.jenjan.com.tw/api/v4/public/logistics/status/${this.trackingNumber}`)
                            .then(response => {
                                this.data = response.data;
                                this.showResults = true;
                            })
                            .catch(error => {
                                console.error(error);
                                this.error = true;
                            })
                            .finally(() => {
                                this.loading = false;
                            });
                    }
                },
                clearInput() {
                    this.trackingNumber = '';
                }
            }
        }).mount('#app');
    </script>
</body>
</html>
